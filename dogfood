#!/bin/bash

gdb=""
gdbextra=""
if [ "$1" == "debug" ]
then
  gdb="gdb -ex run -ex quit --args"
  gdbextra="--fg"
fi

mv -vi ~/rippled/debug.log{,.$(date '+%s')}
time ./Builds/Test.py -v --all -- -j 8 && \
  gnome-terminal -x ${gdb} ./build/gcc.debug/rippled \
    --conf ~/.config/ripple/rippled-validator.cfg --net ${gdbextra}
